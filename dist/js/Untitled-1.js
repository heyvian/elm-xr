import{P as e,M as t,a as r,b as n,V as o,c as a,S as s,W as i,O as d}from"./a4799280.js";let c={};const l=document.querySelector(".js-start-webxr");function showARNotSupported(){l.setAttribute("disabled","disabled"),l.classList.add("is-disabled"),l.textContent="Mixed reality not supported"}navigator.xr.isSessionSupported("immersive-ar").then((e=>{e?function showStartAR(){l.addEventListener("click",(e=>{!async function activateXR(){for(;c.scene.children.length>0;)c.scene.remove(c.scene.children[0]);c.renderer.setClearColor(16777215,0),c.renderer.autoClear=!1;const e=new a;e.matrixAutoUpdate=!1;const s=await navigator.xr.requestSession("immersive-ar",{requiredFeatures:["hit-test"]});s.updateRenderState({baseLayer:new XRWebGLLayer(s,c.gl)});const i=await s.requestReferenceSpace("local"),d=await s.requestReferenceSpace("viewer"),l=await s.requestHitTestSource({space:d});let p,u;m.load("dist/models/recticle.ply",(function(e){e.center(),e.rotateX(t.degToRad(-90));const a=new r(e,new n({vertexColors:o,size:.002,opacity:.65}));p=a,p.visible=!1,c.scene.add(p),console.log("Reticle model loaded")})),m.load("dist/models/elm.ply",(function(e){e.center(),e.rotateX(t.degToRad(-90)),e.translate(0,e.boundingBox.max.y,1);const a=new r(e,new n({vertexColors:o,size:.025}));u=a,u.position.copy(p.position),u.visible=!1,c.scene.add(u),console.log("Main model loaded")})),s.addEventListener("select",(e=>{console.log(e,e.inputSource),u&&(u.visible=!0,u.position.copy(p.position))}));const onXRFrame=(t,r)=>{s.requestAnimationFrame(onXRFrame),c.gl.bindFramebuffer(c.gl.FRAMEBUFFER,s.renderState.baseLayer.framebuffer);const n=r.getViewerPose(i);if(n){const t=n.views[0],o=s.renderState.baseLayer.getViewport(t);c.renderer.setSize(o.width,o.height),e.matrix.fromArray(t.transform.matrix),e.projectionMatrix.fromArray(t.projectionMatrix),e.updateMatrixWorld(!0);const a=r.getHitTestResults(l);if(a.length>0&&p){const e=a[0].getPose(i);p.visible=!0,p.position.set(e.transform.position.x,e.transform.position.y,e.transform.position.z),p.updateMatrixWorld(!0)}c.renderer.render(c.scene,e)}};s.requestAnimationFrame(onXRFrame)}()}))}():showARNotSupported()})).catch(showARNotSupported),function initThreeJS(){c.canvas=document.querySelector(".canvas"),c.scene=new s,c.gl=c.canvas.getContext("webgl",{xrCompatible:!0}),c.gl.enable(c.gl.DEPTH_TEST),c.gl.depthFunc(c.gl.LEQUAL),c.renderer=new i({antialias:!0,alpha:!0,preserveDrawingBuffer:!0,canvas:c.canvas,context:c.gl});const e=window.innerHeight/window.innerWidth*10;c.camera=new d(-5,5,e/2,e/-2,1,100),c.camera.position.set(4,1,4),c.camera.lookAt(0,0,0),c.renderer.setSize(window.innerWidth,window.innerHeight),c.renderer.render(c.scene,c.camera),document.body.appendChild(c.renderer.domElement)}();const m=new e;m.load("dist/models/home-elm.ply",(function(e){e.center(),e.rotateX(t.degToRad(-90)),e.translate(-1,e.boundingBox.max.y,0);const a=new r(e,new n({vertexColors:o,size:2.4}));a.position.set(0,-3,0);const s=a;c.scene.add(s),c.renderer.render(c.scene,c.camera),console.log("Home model loaded")}));